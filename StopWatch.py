#â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
#  â–ˆâ–€â€ƒâ–ˆ â–ˆâ€ƒâ–€â–„â–€â€ƒ â€ƒâ–ˆâ–€â–„â–€â–ˆâ€ƒâ–ˆâ–€â–ˆâ€ƒâ–ˆâ–€â–„â€ƒâ–ˆ â–ˆâ€ƒâ–ˆ  â€ƒâ–ˆâ–€â–€â€ƒâ–ˆâ–€ Chanel: https://t.me/shx_modules
#  â–„â–ˆâ€ƒâ–ˆâ–€â–ˆâ€ƒâ–ˆ â–ˆâ€ƒ â€ƒâ–ˆ â–€ â–ˆâ€ƒâ–ˆâ–„â–ˆâ€ƒâ–ˆâ–„â–€â€ƒâ–ˆâ–„â–ˆâ€ƒâ–ˆâ–„â–„â€ƒâ–ˆâ–ˆâ–„â€ƒâ–„â–ˆ Not Licensed
#â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
#  â–ˆâ–€â–€â€ƒâ–€â–„â–€â€ƒâ–ˆ  â€ƒâ–ˆ â–ˆâ€ƒâ–ˆâ–€â€ƒâ–ˆâ€ƒâ–ˆ â–ˆâ€ƒâ–ˆâ–€â–€â€ƒ â€ƒâ–ˆâ–€â–„â–€â–ˆâ€ƒâ–ˆâ–€â–ˆâ€ƒâ–ˆâ–€â–„â€ƒâ–ˆ â–ˆâ€ƒâ–ˆ  â€ƒâ–ˆâ–€â–€â€ƒâ–ˆâ–€
#  â–ˆâ–ˆâ–„â€ƒâ–ˆ â–ˆâ€ƒâ–ˆâ–„â–„â€ƒâ–ˆâ–„â–ˆâ€ƒâ–„â–ˆâ€ƒâ–ˆâ€ƒâ–€â–„â–€â€ƒâ–ˆâ–ˆâ–„â€ƒ â€ƒâ–ˆ â–€ â–ˆâ€ƒâ–ˆâ–„â–ˆâ€ƒâ–ˆâ–„â–€â€ƒâ–ˆâ–„â–ˆâ€ƒâ–ˆâ–„â–„â€ƒâ–ˆâ–ˆâ–„â€ƒâ–„â–ˆ
#â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
# Idea:
# meta developer: @shx_modules
# Thanks: 
#â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

from .. import utils, loader
from ..inline.types import InlineCall
import asyncio 
from asyncio import sleep
import inspect

__version__ = (1, 0, 0)

class StopWatch(loader.Module):
    '''Ğ¡Ñ‚Ğ°Ñ€Ñ‹Ğ¹ Ğ´Ğ¾Ğ±Ñ€Ñ‹Ğ¹ ÑĞµĞºÑƒĞ½Ğ´Ğ¾Ğ¼ĞµÑ€\nDeveloper: @shx_modules'''
    strings = {
        'name': 'StopWatch',
    }

    async def client_ready(self):
        self.set('fact_status', False)
        if self.get('format') == None:
            self.set('format', 'ÑĞµĞºÑƒĞ½Ğ´Ñ‹')

    @loader.command(alias = 'swreset')
    async def stopwatchreset(self, message):
        '''- Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ° Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ'''
        self.set('fact_status', False)
        self.set('status', False)
        self.set('seconds',0)
        await utils.answer(message, f'<emoji document_id=5332533929020761310>âœ…</emoji> StopWatch Ğ¿ĞµÑ€ĞµĞ·Ğ°Ğ³Ñ€ÑƒĞ¶ĞµĞ½.')

    @loader.command(alias = 'sw')
    async def stopwatch(self, message):
        '''- Ğ·Ğ°Ğ¿ÑƒÑÑ‚Ğ¸Ñ‚ÑŒ ÑĞµĞºÑƒĞ½Ğ´Ğ¾Ğ¼ĞµÑ€'''
        error_cmd = f'{utils.escape_html(self.get_prefix())}{inspect.currentframe().f_code.co_name}'
        if message.is_private:
            
            if self.get('fact_status') == False:
                self.set('seconds', 0)
                format = self.get('format')


                await self.inline.form(
                    text = 'ğŸš€ <b>StopWatch v1.0</b>\n\n',
                    message=message,
                    reply_markup=[
                        [
                            {
                                "text": "â–¶ Ğ¡Ñ‚Ğ°Ñ€Ñ‚",
                                "callback": self.start,
                            },
                            
                        ],
                        [
                            {
                                "text": "ğŸ”„ Ğ¡Ğ±Ñ€Ğ¾Ñ",
                                "callback": self.reset,
                            },
                        ],
                        [
                            {
                                'text':f'ğŸ“„ Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: {format}',
                                'callback': self.format,
                            }
                        ],
                        [
                            {
                                "text": "ğŸ—‘ï¸ ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑĞµĞºÑƒĞ½Ğ´Ğ¾Ğ¼ĞµÑ€",
                                "callback": self.stop_full,
                            },
                        ],
                            
                    ],
                )
            else:
                await utils.answer(message, f'<emoji document_id=5877477244938489129>ğŸš«</emoji> <b>Error</b> | <code>{error_cmd}</code>\nĞ£ Ğ²Ğ°Ñ ÑƒĞ¶Ğµ Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½ ÑĞµĞºÑƒĞ½Ğ´Ğ¾Ğ¼ĞµÑ€, Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ ĞµĞ³Ğ¾ Ğ¸Ğ»Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ {utils.escape_html(self.get_prefix())}stopwatchreset')
                return
        else:
            await utils.answer(message, f'<emoji document_id=5877477244938489129>ğŸš«</emoji> <b>Error</b> | <code>{error_cmd}</code>\nĞš ÑĞ¾Ğ¶Ğ°Ğ»ĞµĞ½Ğ¸Ñ, StopWatch Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ² Ğ»Ğ¸Ñ‡Ğ½Ñ‹Ñ… ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸ÑÑ…... Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾, Ğ±ÑƒĞ´ĞµÑ‚ Ğ¸ÑĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¾.')
            return
        
    async def start(self, call: InlineCall):
        await call.answer(f'â–¶ Ğ—Ğ°Ğ¿ÑƒÑ‰ĞµĞ½Ğ¾')
        self.set('status', True)
        self.set('fact_status', True)
        while True:
            await asyncio.sleep(1)
            seconds = self.get('seconds')
            if self.get('status') == True:
                seconds += 1
                self.set('seconds', seconds)
                format = self.get('format')
                if format == 'Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹':
                    if seconds < 60:
                        txt = f'ğŸš€ <b>StopWatch v1.0</b>\n\n{seconds}ÑĞµĞº.'
                    if seconds >= 60:
                        m = int(seconds/60)
                        s = seconds%60
                        txt = f'ğŸš€ <b>StopWatch v1.0</b>\n\n{m}Ğ¼Ğ¸Ğ½. {s}ÑĞµĞº. '
                    if seconds >= 3600:
                        h = int(seconds/3600)
                        m1 = int(seconds - 3600)
                        m = m1/60
                        s = m1%60
                        txt = f'ğŸš€ <b>StopWatch v1.0</b>\n\n{h}Ñ‡. {m}Ğ¼Ğ¸Ğ½. {s}ÑĞµĞº.'
                else:
                    txt = f'ğŸš€ <b>StopWatch v1.0</b>\n\n{seconds}ÑĞµĞº.'
                await call.edit(
                    text=txt,
                    reply_markup=[
                        [
                            {
                                'text': 'â¸ Ğ¡Ñ‚Ğ¾Ğ¿',
                                'callback': self.stop,
                            }
                        ],
                        [
                            {
                                "text": "ğŸ”„ Ğ¡Ğ±Ñ€Ğ¾Ñ",
                                "callback": self.reset,
                            },
                        ],
                        [
                            {
                                'text':f'ğŸ“„ Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: {format}',
                                'callback': self.format,
                            }
                        ],
                        [
                            {
                                "text": "ğŸ—‘ï¸ ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑĞµĞºÑƒĞ½Ğ´Ğ¾Ğ¼ĞµÑ€",
                                "callback": self.stop_full,
                            },
                        ],
                    ]
                )
            else:
                break
                    

    async def stop(self, call: InlineCall):
        await call.answer(f'â¸ ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¾')
        self.set('status', False)
        seconds = self.get('seconds')
        format = self.get('format')
        if format == 'Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹':
            if seconds < 60:
                txt = f'ğŸš€ <b>StopWatch v1.0</b>\n\n{seconds}ÑĞµĞº.'
            if seconds >= 60:
                m = int(seconds/60)
                s = seconds%60
                txt = f'ğŸš€ <b>StopWatch v1.0</b>\n\n{m}Ğ¼Ğ¸Ğ½. {s}ÑĞµĞº. '
            if seconds >= 3600:
                h = int(seconds/3600)
                m1 = int(seconds - 3600)
                m = m1/60
                s = m1%60
                txt = f'ğŸš€ <b>StopWatch v1.0</b>\n\n{h}Ñ‡. {m}Ğ¼Ğ¸Ğ½. {s}ÑĞµĞº.'
        else:
            txt = f'ğŸš€ <b>StopWatch v1.0</b>\n\n{seconds}ÑĞµĞº.'
        await call.edit(
            text=txt,
            reply_markup=[
                [
                    {
                        "text": "â–¶ Ğ¡Ñ‚Ğ°Ñ€Ñ‚",
                        "callback": self.start,
                    },
                    
                ],
                [
                    {
                        "text": "ğŸ”„ Ğ¡Ğ±Ñ€Ğ¾Ñ",
                        "callback": self.reset,
                    },
                ],
                [
                    {
                        'text':f'ğŸ“„ Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: {format}',
                        'callback': self.format,
                    }
                ],
                [
                    {
                        "text": "ğŸ—‘ï¸ ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑĞµĞºÑƒĞ½Ğ´Ğ¾Ğ¼ĞµÑ€",
                        "callback": self.stop_full,
                    },
                ],
            ]
        )

    async def reset(self, call: InlineCall):
        await call.answer('ğŸ”„ Ğ¡Ğ±Ñ€Ğ¾ÑˆĞµĞ½Ğ¾')
        self.set('seconds', 0)
        self.set('status', False)
        seconds = self.get('seconds')
        format = self.get('format')
        if format == 'Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹':
            if seconds < 60:
                txt = f'ğŸš€ <b>StopWatch v1.0</b>\n\n{seconds}ÑĞµĞº.'
            if seconds >= 60:
                m = int(seconds/60)
                s = seconds%60
                txt = f'ğŸš€ <b>StopWatch v1.0</b>\n\n{m}Ğ¼Ğ¸Ğ½. {s}ÑĞµĞº. '
            if seconds >= 3600:
                h = int(seconds/3600)
                m1 = int(seconds - 3600)
                m = m1/60
                s = m1%60
                txt = f'ğŸš€ <b>StopWatch v1.0</b>\n\n{h}Ñ‡. {m}Ğ¼Ğ¸Ğ½. {s}ÑĞµĞº.'
        else:
            txt = f'ğŸš€ <b>StopWatch v1.0</b>\n\n{seconds}ÑĞµĞº.'
        await call.edit(
            text=txt,
            reply_markup=[
                [
                    {
                        "text": "â–¶ Ğ¡Ñ‚Ğ°Ñ€Ñ‚",
                        "callback": self.start,
                    },
                ],
                [
                    {
                        "text": "ğŸ”„ Ğ¡Ğ±Ñ€Ğ¾Ñ",
                        "callback": self.reset,
                    },
                ],
                [
                    {
                        'text':f'ğŸ“„ Ğ¤Ğ¾Ñ€Ğ¼Ğ°Ñ‚: {format}',
                        'callback': self.format,
                    }
                ],
                [
                    {
                        "text": "ğŸ—‘ï¸ ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑĞµĞºÑƒĞ½Ğ´Ğ¾Ğ¼ĞµÑ€",
                        "callback": self.stop_full,
                    },
                ],
            ]
        )

    async def stop_full(self, call: InlineCall):
        self.set('seconds', 0)
        self.set('status', False)
        self.set('fact_status', False)
        await call.edit(
            text=f'ğŸ—‘ï¸ StopWatch Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½.',
            
        )

    async def format(self, call: InlineCall):
        
        if self.get('format') == 'ÑĞµĞºÑƒĞ½Ğ´Ñ‹':
            await call.answer('ğŸ“„ ĞĞ¾Ğ²Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚: Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹')
            self.set('format', 'Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹')
        else:
            self.set('format', 'ÑĞµĞºÑƒĞ½Ğ´Ñ‹')
            await call.answer('ğŸ“„ ĞĞ¾Ğ²Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚: ÑĞµĞºÑƒĞ½Ğ´Ñ‹')
        
